<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pygama.dsp.processors package &mdash; pygama  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pygama.evt package" href="pygama.evt.html" />
    <link rel="prev" title="pygama.dsp package" href="pygama.dsp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> pygama
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manuals/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials (Jupyter notebooks)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Package API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pygama.html">pygama package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pygama.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="pygama.dsp.html">pygama.dsp package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.evt.html">pygama.evt package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.flow.html">pygama.flow package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.hit.html">pygama.hit package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.lgdo.html">pygama.lgdo package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.math.html">pygama.math package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.pargen.html">pygama.pargen package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.raw.html">pygama.raw package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pygama.vis.html">pygama.vis package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pygama.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygama.html#module-pygama.cli">pygama.cli module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer's guide</a></li>
</ul>

    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: main
        <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
        <dl>
          <dt>Branches</dt>
          <dd><a href="pygama.dsp.processors.html">main</a></dd>
          <dd><a href="../../refactor/index.html">refactor</a></dd>
          <dd><a href="../../releases/v0.9/index.html">releases/v0.9</a></dd>
          <dd><a href="../../releases/v1.0/index.html">releases/v1.0</a></dd>
        </dl>
      </div>
    </div>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pygama</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">pygama</a> &raquo;</li>
          <li><a href="pygama.html">pygama package</a> &raquo;</li>
          <li><a href="pygama.dsp.html">pygama.dsp package</a> &raquo;</li>
      <li>pygama.dsp.processors package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/pygama.dsp.processors.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pygama.dsp.processors">
<span id="pygama-dsp-processors-package"></span><h1>pygama.dsp.processors package<a class="headerlink" href="#module-pygama.dsp.processors" title="Permalink to this heading"></a></h1>
<p>Contains a list of DSP processors, implemented using Numba's
<a class="reference external" href="https://numba.readthedocs.io/en/stable/reference/jit-compilation.html#numba.guvectorize" title="(in Numba v0.56)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numba.guvectorize()</span></code></a> to implement NumPy's <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ufunc</span></code></a> interface.
In other words, all of the functions are void functions whose outputs are given
as parameters.  The <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a> interface provides additional
information about the function signatures that enables broadcasting the arrays
and SIMD processing. Thanks to the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a> interface, they can
also be called to return a NumPy array, but if this is done, memory will be
allocated for this array, slowing things down.</p>
<p>The pygama processors use the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a> framework, which is
designed to encourage highly performant python practices. These functions have
several advantages:</p>
<ol class="arabic">
<li><p>They work with <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>. NumPy arrays are arrays of same-typed
objects that are stored adjacently in memory (equivalent to a dynamically
allocated C-array or a C++ vector). Compared to standard Python lists, they
perform computations much faster. They are ideal for representing waveforms
and transformed waveforms.</p></li>
<li><p>They perform vectorized operations. Vectorization causes commands to
perform the same operation on all components of an array. For example, the
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a> <code class="docutils literal notranslate"><span class="pre">np.add(a,</span> <span class="pre">b,</span> <span class="pre">out=c)</span></code> (equivalently <code class="docutils literal notranslate"><span class="pre">c=a+b</span></code>) is
equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)):</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>Loops are slow in python since it is an interpreted language; vectorized
commands remove the loop and only call the Python interpreter once.</p>
<p>Furthermore, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a>s are capable of <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/ufuncs.html#broadcasting">broadcasting</a>
their dimensions. This involves a safety check to ensure the dimensions of
<code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are compatible sizes. It also will automatically replicate a
<code class="docutils literal notranslate"><span class="pre">size-1</span></code> dimension over another one, enabling the addition of a scalar to
a vector quantity. This is useful, as it allows us to process multiple
waveforms at once.</p>
<p>One of the biggest advantages of vectorized <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a>s is that
many of them will take advantage of SIMD (same input-multiple data)
vectorization on a vector-CPU. Modern CPUs typically have 256- or 512-bit
wide processing units, which can accommodate multiple 32- or 64-bit numbers.
Programming with these, however, is quite difficult and requires specialized
commands to be called.  Luckily for us, many NumPy <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a>s
will automatically use these for us, speeding up our code!</p>
</li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a>s are capable of calculating their output in place,
meaning they can place calculated values in pre-allocated memory rather than
allocating and returning new values. This is important because memory
allocation is one of the slowest processes computers can perform, and should
be avoided. With <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a>s, this can be done using the out
keyword in arguments (ex <code class="docutils literal notranslate"><span class="pre">numpy.add(a,</span> <span class="pre">b,</span> <span class="pre">out=c)</span></code>, or more succinctly,
<code class="docutils literal notranslate"><span class="pre">numpy.add(a,</span> <span class="pre">b,</span> <span class="pre">c)</span></code>).  While this may seem counterintuitive at first, the
alternative (<code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">np.add(a,b)</span></code> or <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">a+b</span></code>) causes an entirely new
array to be allocated, with c pointing at that. These array allocations can
add up very quickly: <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">=</span> <span class="pre">a*b</span> <span class="pre">+</span> <span class="pre">c*d</span></code>, for example, would allocate 3
different arrays: one for <code class="docutils literal notranslate"><span class="pre">a*b</span></code>, one for <code class="docutils literal notranslate"><span class="pre">c*d</span></code>, and one for the sum of
those two. As we write <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code></a>s, it is important that we try
to use functions that operate in place as much as possible!</p></li>
</ol>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pygama.dsp.processors.bl_subtract">
<span id="pygama-dsp-processors-bl-subtract-module"></span><h2>pygama.dsp.processors.bl_subtract module<a class="headerlink" href="#module-pygama.dsp.processors.bl_subtract" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.bl_subtract.bl_subtract">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.bl_subtract.</span></span><span class="sig-name descname"><span class="pre">bl_subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.bl_subtract.bl_subtract" title="Permalink to this definition"></a></dt>
<dd><p>Subtract the constant baseline from the entire waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>a_baseline</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the baseline value to subtract.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the output waveform with the baseline subtracted.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_bl&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bl_subtract&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_bl&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.convolutions">
<span id="pygama-dsp-processors-convolutions-module"></span><h2>pygama.dsp.processors.convolutions module<a class="headerlink" href="#module-pygama.dsp.processors.convolutions" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.convolutions.cusp_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.convolutions.</span></span><span class="sig-name descname"><span class="pre">cusp_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.convolutions.cusp_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a CUSP filter to the waveform.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processor is composed of a factory function that is called using the
<cite>init_args</cite> argument. The input and output waveforms are passed using
<cite>args</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the length of the filter to be convolved.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the curvature of the rising and falling part of the kernel.</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the length of the flat section.</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the decay constant of the exponential to be convolved.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_cusp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cusp_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_cusp(101,f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;init_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;len(wf_bl)-100&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;40*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;45*us&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.convolutions.t0_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.convolutions.</span></span><span class="sig-name descname"><span class="pre">t0_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.convolutions.t0_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a modified, asymmetric trapezoidal filter to the waveform.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processor is composed of a factory function that is called using the
<cite>init_args</cite> argument. The input and output waveforms are passed using
<cite>args</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the length of the rise section. This is the linearly increasing
section of the filter that performs a weighted average.</p></li>
<li><p><strong>fall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the length of the fall section. This is the simple averaging part
of the filter.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_t0_filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;t0_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_t0_filter(3748,f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;init_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;128*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2*us&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.convolutions.zac_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.convolutions.</span></span><span class="sig-name descname"><span class="pre">zac_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.convolutions.zac_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a ZAC (Zero Area CUSP) filter to the waveform.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processor is composed of a factory function that is called using the
<cite>init_args</cite> argument. The input and output waveforms are passed using
<cite>args</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the length of the filter to be convolved.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the curvature of the rising and falling part of the kernel.</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the length of the flat section.</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the decay constant of the exponential to be convolved.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_zac&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;zac_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_zac(101,f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;init_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;len(wf_bl)-100&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;40*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;45*us&quot;</span><span class="p">],</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.fftw">
<span id="pygama-dsp-processors-fftw-module"></span><h2>pygama.dsp.processors.fftw module<a class="headerlink" href="#module-pygama.dsp.processors.fftw" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.fftw.dft">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.fftw.</span></span><span class="sig-name descname"><span class="pre">dft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.fftw.dft" title="Permalink to this definition"></a></dt>
<dd><p>Perform discrete Fourier transforms using the FFTW library.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processor is composed of a factory function that is called using the
<cite>init_args</cite> argument. The input and output waveforms are passed using
<cite>args</cite>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FFTW optimizes the FFT algorithm based on the size of the arrays, with SIMD
parallelized commands.  This optimization requires initialization, so this
is a factory function that returns a Numba gufunc that performs the FFT.
FFTW works on fixed memory buffers, so you must tell it what memory to use
ahead of time.  When using this with
<a class="reference internal" href="pygama.dsp.html#pygama.dsp.processing_chain.ProcessingChain" title="pygama.dsp.processing_chain.ProcessingChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessingChain</span></code></a>, to ensure the correct
buffers are used, call
<a class="reference internal" href="pygama.dsp.html#pygama.dsp.processing_chain.ProcessingChain.get_variable" title="pygama.dsp.processing_chain.ProcessingChain.get_variable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_variable()</span></code></a> to give it the
internal memory buffer directly. With <a class="reference internal" href="pygama.dsp.html#pygama.dsp.build_dsp.build_dsp" title="pygama.dsp.build_dsp.build_dsp"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_dsp()</span></code></a>,
you can just give it the name, and it will automatically happen. The
possible <cite>dtypes</cite> for the input/outputs are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 11%" />
<col style="width: 37%" />
<col style="width: 15%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.dtype</span></code></a></p></td>
<td><p>Size</p></td>
<td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.dtype</span></code></a></p></td>
<td><p>Size</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code>/<code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code>/<code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float128</span></code>/<code class="docutils literal notranslate"><span class="pre">longdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex256</span></code>/<code class="docutils literal notranslate"><span class="pre">clongdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complex256</span></code>/<code class="docutils literal notranslate"><span class="pre">clongdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex256</span></code>/<code class="docutils literal notranslate"><span class="pre">clongdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.fftw.inv_dft">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.fftw.</span></span><span class="sig-name descname"><span class="pre">inv_dft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.fftw.inv_dft" title="Permalink to this definition"></a></dt>
<dd><p>Perform inverse discrete Fourier transforms using the FFTW library.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processor is composed of a factory function that is called using the
<cite>init_args</cite> argument. The input and output waveforms are passed using
<cite>args</cite>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FFTW optimizes the FFT algorithm based on the size of the arrays, with SIMD
parallelized commands.  This optimization requires initialization, so this
is a factory function that returns a Numba gufunc that performs the FFT.
FFTW works on fixed memory buffers, so you must tell it what memory to use
ahead of time.  When using this with
<a class="reference internal" href="pygama.dsp.html#pygama.dsp.processing_chain.ProcessingChain" title="pygama.dsp.processing_chain.ProcessingChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessingChain</span></code></a>, to ensure the correct
buffers are used, call
<a class="reference internal" href="pygama.dsp.html#pygama.dsp.processing_chain.ProcessingChain.get_variable" title="pygama.dsp.processing_chain.ProcessingChain.get_variable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_variable()</span></code></a> to give it the
internal memory buffer directly. With <a class="reference internal" href="pygama.dsp.html#pygama.dsp.build_dsp.build_dsp" title="pygama.dsp.build_dsp.build_dsp"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_dsp()</span></code></a>,
you can just give it the name, and it will automatically happen. The
possible <cite>dtypes</cite> for the input/outputs are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 15%" />
<col style="width: 37%" />
<col style="width: 11%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.dtype</span></code></a></p></td>
<td><p>Size</p></td>
<td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.dtype</span></code></a></p></td>
<td><p>Size</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code>/<code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code>/<code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex256</span></code>/<code class="docutils literal notranslate"><span class="pre">clongdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float128</span></code>/<code class="docutils literal notranslate"><span class="pre">longdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complex256</span></code>/<code class="docutils literal notranslate"><span class="pre">clongdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex256</span></code>/<code class="docutils literal notranslate"><span class="pre">clongdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.fftw.psd">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.fftw.</span></span><span class="sig-name descname"><span class="pre">psd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buf_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">buf_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.fftw.psd" title="Permalink to this definition"></a></dt>
<dd><p>Perform discrete Fourier transforms using the FFTW library, and use it to get
the power spectral density.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processor is composed of a factory function that is called using the
<cite>init_args</cite> argument. The input and output waveforms are passed using
<cite>args</cite>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FFTW optimizes the FFT algorithm based on the size of the arrays, with SIMD
parallelized commands.  This optimization requires initialization, so this
is a factory function that returns a Numba gufunc that performs the FFT.
FFTW works on fixed memory buffers, so you must tell it what memory to use
ahead of time.  When using this with
<a class="reference internal" href="pygama.dsp.html#pygama.dsp.processing_chain.ProcessingChain" title="pygama.dsp.processing_chain.ProcessingChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcessingChain</span></code></a>, to ensure the correct
buffers are used, call
<a class="reference internal" href="pygama.dsp.html#pygama.dsp.processing_chain.ProcessingChain.get_variable" title="pygama.dsp.processing_chain.ProcessingChain.get_variable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_variable()</span></code></a> to give it the
internal memory buffer directly. With <a class="reference internal" href="pygama.dsp.html#pygama.dsp.build_dsp.build_dsp" title="pygama.dsp.build_dsp.build_dsp"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_dsp()</span></code></a>,
you can just give it the name, and it will automatically happen. The
possible <cite>dtypes</cite> for the input/outputs are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 11%" />
<col style="width: 35%" />
<col style="width: 16%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.dtype</span></code></a></p></td>
<td><p>Size</p></td>
<td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.dtype</span></code></a></p></td>
<td><p>Size</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code>/<code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code>/<code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex256</span></code>/<code class="docutils literal notranslate"><span class="pre">clongdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float128</span></code>/<code class="docutils literal notranslate"><span class="pre">longdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code>/<code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code>/<code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code>/<code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code>/<code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float128</span></code>/<code class="docutils literal notranslate"><span class="pre">longdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float128</span></code>/<code class="docutils literal notranslate"><span class="pre">longdouble</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(n/2+1\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.fixed_time_pickoff">
<span id="pygama-dsp-processors-fixed-time-pickoff-module"></span><h2>pygama.dsp.processors.fixed_time_pickoff module<a class="headerlink" href="#module-pygama.dsp.processors.fixed_time_pickoff" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.fixed_time_pickoff.fixed_time_pickoff">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.fixed_time_pickoff.</span></span><span class="sig-name descname"><span class="pre">fixed_time_pickoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.fixed_time_pickoff.fixed_time_pickoff" title="Permalink to this definition"></a></dt>
<dd><p>Pick off the waveform value at the provided index.</p>
<p>If the provided index <cite>t_in</cite> is out of range, return <a class="reference external" href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="(in NumPy v1.23)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.nan</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform</p></li>
<li><p><strong>t_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the waveform index to pick off</p></li>
<li><p><strong>a_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the output pick-off value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;trapEftp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fixed_time_pickoff&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_trap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_0+10*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;trapEftp&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.gaussian_filter1d">
<span id="pygama-dsp-processors-gaussian-filter1d-module"></span><h2>pygama.dsp.processors.gaussian_filter1d module<a class="headerlink" href="#module-pygama.dsp.processors.gaussian_filter1d" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.gaussian_filter1d.gaussian_filter1d">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.gaussian_filter1d.</span></span><span class="sig-name descname"><span class="pre">gaussian_filter1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.gaussian_filter1d.gaussian_filter1d" title="Permalink to this definition"></a></dt>
<dd><p>1-D Gaussian filter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processor is composed of a factory function that is called using the
<cite>init_args</cite> argument. The input and output waveforms are passed using
<cite>args</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- standard deviation for Gaussian kernel</p></li>
<li><p><strong>truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- truncate the filter at this many standard deviations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.get_multi_local_extrema">
<span id="pygama-dsp-processors-get-multi-local-extrema-module"></span><h2>pygama.dsp.processors.get_multi_local_extrema module<a class="headerlink" href="#module-pygama.dsp.processors.get_multi_local_extrema" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.get_multi_local_extrema.get_multi_local_extrema">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.get_multi_local_extrema.</span></span><span class="sig-name descname"><span class="pre">get_multi_local_extrema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_delta_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_max_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_min_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_min_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.get_multi_local_extrema.get_multi_local_extrema" title="Permalink to this definition"></a></dt>
<dd><p>Get lists of indices of the local maxima and minima of data.</p>
<p>The &quot;local&quot; extrema are those maxima (minima) that have heights (depths) of
at least <cite>a_delta_in</cite>.  Converted from a <a class="reference external" href="http://billauer.co.il/peakdet.html">MATLAB script</a> by E. Billauer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the array of data within which extrema will be found.</p></li>
<li><p><strong>a_delta_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the absolute level by which data must vary (in one direction) about an
extremum in order for it to be tagged.</p></li>
<li><p><strong>vt_max_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- arrays of fixed length (padded with <a class="reference external" href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="(in NumPy v1.23)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.nan</span></code></a>) that hold the
indices of the identified local maxima and minima.</p></li>
<li><p><strong>vt_min_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- arrays of fixed length (padded with <a class="reference external" href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="(in NumPy v1.23)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.nan</span></code></a>) that hold the
indices of the identified local maxima and minima.</p></li>
<li><p><strong>n_max_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of maxima and minima found in a waveform.</p></li>
<li><p><strong>n_min_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of maxima and minima found in a waveform.</p></li>
<li><p><strong>flag_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- returns <code class="docutils literal notranslate"><span class="pre">1</span></code> if there is only one maximum and it is a simple waveform,
returns <code class="docutils literal notranslate"><span class="pre">0</span></code> if there are no peaks, or multiple peaks in a waveform.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.linear_slope_fit">
<span id="pygama-dsp-processors-linear-slope-fit-module"></span><h2>pygama.dsp.processors.linear_slope_fit module<a class="headerlink" href="#module-pygama.dsp.processors.linear_slope_fit" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.linear_slope_fit.linear_slope_fit">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.linear_slope_fit.</span></span><span class="sig-name descname"><span class="pre">linear_slope_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.linear_slope_fit.linear_slope_fit" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the mean and standard deviation of the waveform using
Welford's method as well as the slope an intercept of the waveform
using linear regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the mean of the waveform.</p></li>
<li><p><strong>stdev</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the standard deviation of the waveform.</p></li>
<li><p><strong>slope</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the slope of the linear fit.</p></li>
<li><p><strong>intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the intercept of the linear fit.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;bl_mean, bl_std, bl_slope, bl_intercept&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;linear_slope_fit&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_blsub[0:1650]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_mean&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_std&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_slope&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_intercept&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">],</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.log_check">
<span id="pygama-dsp-processors-log-check-module"></span><h2>pygama.dsp.processors.log_check module<a class="headerlink" href="#module-pygama.dsp.processors.log_check" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.log_check.log_check">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.log_check.</span></span><span class="sig-name descname"><span class="pre">log_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.log_check.log_check" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the logarithm of the waveform if all its values
are positive; otherwise, return NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>w_log</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the output waveform with logged values.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_logged&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;log_check&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_blsub[2100:]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_logged&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.min_max">
<span id="pygama-dsp-processors-min-max-module"></span><h2>pygama.dsp.processors.min_max module<a class="headerlink" href="#module-pygama.dsp.processors.min_max" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.min_max.min_max">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.min_max.</span></span><span class="sig-name descname"><span class="pre">min_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.min_max.min_max" title="Permalink to this definition"></a></dt>
<dd><p>Find the value and index of the minimum and maximum values
in the waveform.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first found instance of each extremum in the waveform will be returned.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform</p></li>
<li><p><strong>t_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the index of the minimum value</p></li>
<li><p><strong>t_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the index of the maximum value</p></li>
<li><p><strong>a_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the minimum value</p></li>
<li><p><strong>a_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the maximum value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;tp_min, tp_max, wf_min, wf_max&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;min_max&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_min&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_max&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_min&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_max&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.moving_windows">
<span id="pygama-dsp-processors-moving-windows-module"></span><h2>pygama.dsp.processors.moving_windows module<a class="headerlink" href="#module-pygama.dsp.processors.moving_windows" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.moving_windows.avg_current">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.moving_windows.</span></span><span class="sig-name descname"><span class="pre">avg_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.moving_windows.avg_current" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the derivative of a waveform, averaged across <cite>length</cite> samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- length of the moving window to be applied.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- output waveform after derivation.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;curr&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;avg_current&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;curr(len(wf_pz)-1, f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC/sample&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.moving_windows.moving_window_left">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.moving_windows.</span></span><span class="sig-name descname"><span class="pre">moving_window_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.moving_windows.moving_window_left" title="Permalink to this definition"></a></dt>
<dd><p>Applies a moving average window to the waveform.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starts from the left and assumes that the baseline is at zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- length of the moving window to be applied.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- output waveform after moving window applied.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_mw&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;moving_window_left&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;96*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_mw&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.moving_windows.moving_window_multi">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.moving_windows.</span></span><span class="sig-name descname"><span class="pre">moving_window_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.moving_windows.moving_window_multi" title="Permalink to this definition"></a></dt>
<dd><p>Apply a series of moving-average windows to the waveform, alternating
its application between the left and the right.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- length of the moving window to be applied.</p></li>
<li><p><strong>num_mw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of moving windows.</p></li>
<li><p><strong>mw_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> -- alternate moving windows right and left</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> -- only left</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> -- only right</p></li>
</ul>
</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the windowed waveform.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;curr_av&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;moving_window_multi&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;curr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;96*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;curr_av&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC/sample&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.moving_windows.moving_window_right">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.moving_windows.</span></span><span class="sig-name descname"><span class="pre">moving_window_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.moving_windows.moving_window_right" title="Permalink to this definition"></a></dt>
<dd><p>Applies a moving average window to the waveform from the right.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- length of the moving window to be applied.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- output waveform after moving window applied.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_mw&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;moving_window_right&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;96*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_mw&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.multi_a_filter">
<span id="pygama-dsp-processors-multi-a-filter-module"></span><h2>pygama.dsp.processors.multi_a_filter module<a class="headerlink" href="#module-pygama.dsp.processors.multi_a_filter" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.multi_a_filter.multi_a_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.multi_a_filter.</span></span><span class="sig-name descname"><span class="pre">multi_a_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_maxs_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">va_max_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp.processors.multi_a_filter.multi_a_filter" title="Permalink to this definition"></a></dt>
<dd><p>Finds the maximums in a waveform and returns the amplitude of the wave at those points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<em>array-like</em>) -- The array of data within which amplitudes of extrema will be found</p></li>
<li><p><strong>vt_maxs_in</strong> (<em>array-like</em>) -- The array of max positions for each wf</p></li>
<li><p><strong>va_max_out</strong> (<em>array-like</em>) -- An array (in-place filled) of the amplitudes of the maximums of the waveform</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.multi_t_filter">
<span id="pygama-dsp-processors-multi-t-filter-module"></span><h2>pygama.dsp.processors.multi_t_filter module<a class="headerlink" href="#module-pygama.dsp.processors.multi_t_filter" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.multi_t_filter.multi_t_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.multi_t_filter.</span></span><span class="sig-name descname"><span class="pre">multi_t_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_threshold_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_max_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_min_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.multi_t_filter.multi_t_filter" title="Permalink to this definition"></a></dt>
<dd><p>Gets list of indices of the start of leading edges of multiple peaks
within a waveform.</p>
<p>Is built to handle afterpulses/delayed cross-talk and trains of pulses.
Works by calling the vectorized functions <a class="reference internal" href="#pygama.dsp.processors.get_multi_local_extrema.get_multi_local_extrema" title="pygama.dsp.processors.get_multi_local_extrema.get_multi_local_extrema"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_multi_local_extrema()</span></code></a>
which returns a list of the maxima and minima in a waveform, and then the
list of maxima is fed into <a class="reference internal" href="#pygama.dsp.processors.time_point_thresh.time_point_thresh" title="pygama.dsp.processors.time_point_thresh.time_point_thresh"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_point_thresh()</span></code></a> which returns the
final times that waveform is less than a specified threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the array of data within which the list of leading edge times will be
found.</p></li>
<li><p><strong>a_threshold_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- threshold to search for using <a class="reference internal" href="#pygama.dsp.processors.time_point_thresh.time_point_thresh" title="pygama.dsp.processors.time_point_thresh.time_point_thresh"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_point_thresh()</span></code></a>.</p></li>
<li><p><strong>vt_max_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the array of maximum positions for each waveform.</p></li>
<li><p><strong>vt_min_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the array of minimum positions for each waveform.</p></li>
<li><p><strong>t_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- output array of fixed length (padded with <a class="reference external" href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="(in NumPy v1.23)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.nan</span></code></a>) that hold
the indices of the identified initial rise times of peaks in the
signal.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygama.dsp.processors.time_point_thresh.time_point_thresh" title="pygama.dsp.processors.time_point_thresh.time_point_thresh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">time_point_thresh</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.multi_t_filter.remove_duplicates">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.multi_t_filter.</span></span><span class="sig-name descname"><span class="pre">remove_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vt_min_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.multi_t_filter.remove_duplicates" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to remove duplicate peak positions.</p>
<p><a class="reference internal" href="#pygama.dsp.processors.time_point_thresh.time_point_thresh" title="pygama.dsp.processors.time_point_thresh.time_point_thresh"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_point_thresh()</span></code></a> has issues with afterpulsing in waveforms that
causes an aferpulse peak position to be sent to zero or the same index as
the first pulse. This only happens when the relative minimum between the
first pulse and the afterpulse is greater than the threshold. So, we sweep
through the array again to ensure there are no duplicate indices. If there
are duplicate indices caused by a misidentified position of an afterpulse,
we replace its index by that of the corresponding minimum found using
<a class="reference internal" href="#pygama.dsp.processors.get_multi_local_extrema.get_multi_local_extrema" title="pygama.dsp.processors.get_multi_local_extrema.get_multi_local_extrema"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_multi_local_extrema()</span></code></a>. It also checks to make sure that the
maximum of a waveform isn't right at index 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the array of indices that we want to remove duplicates from.</p></li>
<li><p><strong>vt_min_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- list of indices of minima that we want to replace duplicates in <cite>t_out</cite>
with.</p></li>
<li><p><strong>t_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the array we want to return that will have no duplicate indices in it.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygama.dsp.processors.multi_t_filter.multi_t_filter" title="pygama.dsp.processors.multi_t_filter.multi_t_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multi_t_filter</span></code></a></p>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.optimize">
<span id="pygama-dsp-processors-optimize-module"></span><h2>pygama.dsp.processors.optimize module<a class="headerlink" href="#module-pygama.dsp.processors.optimize" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygama.dsp.processors.optimize.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.optimize.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygama.dsp.processors.optimize.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class representing the function to minimize.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.optimize.optimize_1pz">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.optimize.</span></span><span class="sig-name descname"><span class="pre">optimize_1pz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_baseline_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_beg_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">val0_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.optimize.optimize_1pz" title="Permalink to this definition"></a></dt>
<dd><p>Find the optimal, single pole-zero cancellation's parameter
by minimizing the slope in the waveform's specified time range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>a_baseline_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the resting baseline.</p></li>
<li><p><strong>t_beg_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the lower bound's index for the time range over
which to optimize the pole-zero cancellation.</p></li>
<li><p><strong>t_end_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the upper bound's index for the time range over
which to optimize the pole-zero cancellation.</p></li>
<li><p><strong>p0_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the initial guess of the optimal time constant.</p></li>
<li><p><strong>val0_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the output value of the best-fit time constant.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;tau0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;optimize_1pz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;20*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;500*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tau0&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygama.dsp.processors.pole_zero.pole_zero" title="pygama.dsp.processors.pole_zero.pole_zero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pole_zero</span></code></a>, <a class="reference internal" href="#pygama.dsp.processors.pole_zero.double_pole_zero" title="pygama.dsp.processors.pole_zero.double_pole_zero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double_pole_zero</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.optimize.optimize_2pz">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.optimize.</span></span><span class="sig-name descname"><span class="pre">optimize_2pz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_baseline_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_beg_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">val0_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">val1_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">val2_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.optimize.optimize_2pz" title="Permalink to this definition"></a></dt>
<dd><p>Find the optimal, double pole-zero cancellation's parameters by
minimizing the slope in the waveform's specified time range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>a_baseline_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the resting baseline.</p></li>
<li><p><strong>t_beg_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the lower bound's index for the time range over
which to optimize the pole-zero cancellation.</p></li>
<li><p><strong>t_end_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the upper bound's index for the time range over
which to optimize the pole-zero cancellation.</p></li>
<li><p><strong>p0_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the initial guess of the optimal, longer time constant.</p></li>
<li><p><strong>p1_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the initial guess of the optimal, shorter time constant.</p></li>
<li><p><strong>p2_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the initial guess of the optimal fraction.</p></li>
<li><p><strong>val0_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the output value of the best-fit, longer time constant.</p></li>
<li><p><strong>val1_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the output value of the best-fit, shorter time constant.</p></li>
<li><p><strong>val2_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the output value of the best-fit fraction.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;tau1, tau2, frac&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;optimize_2pz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;20*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;500*us&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;20*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0.02&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tau1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tau2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;frac&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.param_lookup">
<span id="pygama-dsp-processors-param-lookup-module"></span><h2>pygama.dsp.processors.param_lookup module<a class="headerlink" href="#module-pygama.dsp.processors.param_lookup" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.param_lookup.param_lookup">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.param_lookup.</span></span><span class="sig-name descname"><span class="pre">param_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v1.23)"><span class="pre">numpy.dtype</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><span class="pre">ufunc</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.param_lookup.param_lookup" title="Permalink to this definition"></a></dt>
<dd><p>Generate the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ufunc</span></code></a> <code class="docutils literal notranslate"><span class="pre">lookup(channel,</span> <span class="pre">val)</span></code>, which
returns a NumPy array of values corresponding to various channels that are
looked up in the provided <cite>param_dict</cite>.  If there is no key, use
<cite>default_val</cite> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="(in NumPy v1.23)"><em>ufunc</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.pole_zero">
<span id="pygama-dsp-processors-pole-zero-module"></span><h2>pygama.dsp.processors.pole_zero module<a class="headerlink" href="#module-pygama.dsp.processors.pole_zero" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.pole_zero.double_pole_zero">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.pole_zero.</span></span><span class="sig-name descname"><span class="pre">double_pole_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_tau1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_tau2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.pole_zero.double_pole_zero" title="Permalink to this definition"></a></dt>
<dd><p>Apply a double pole-zero cancellation using the provided time
constants to the waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>t_tau1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the time constant of the first exponential to be deconvolved.</p></li>
<li><p><strong>t_tau2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the time constant of the second exponential to be deconvolved.</p></li>
<li><p><strong>frac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the fraction which the second exponential contributes.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the pole-zero cancelled waveform.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a></p>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_pz&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;double_pole_zero&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;400*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;20*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;0.02&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_pz&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This algorithm is an IIR filter to deconvolve the function</p>
<div class="math notranslate nohighlight">
\[s(t) = A \left[ f \cdot \exp\left(-\frac{t}{\tau_2} \right)
       + (1-f) \cdot \exp\left(-\frac{t}{\tau_1}\right) \right]\]</div>
<p>(<span class="math notranslate nohighlight">\(f\)</span> = <cite>frac</cite>) into a single step function of amplitude <span class="math notranslate nohighlight">\(A\)</span>.
This filter is derived by <span class="math notranslate nohighlight">\(z\)</span>-transforming the input (<span class="math notranslate nohighlight">\(s(t)\)</span>)
and output (step function) signals, and then determining the transfer
function. For shorthand, define <span class="math notranslate nohighlight">\(a=\exp(-1/\tau_1)\)</span> and
<span class="math notranslate nohighlight">\(b=\exp(-1/\tau_2)\)</span>, the transfer function is then:</p>
<div class="math notranslate nohighlight">
\[H(z) = \frac{1 - (a+b)z^{-1} + abz^{-2}}
            {1 + (fb - fa - b - 1)z^{-1}-(fb - fa - b)z^{-2}}\]</div>
<p>By equating the transfer function to the ratio of output to input waveforms
<span class="math notranslate nohighlight">\(H(z) = w_\text{out}(z) / w_\text{in}(z)\)</span> and then taking the
inverse <span class="math notranslate nohighlight">\(z\)</span>-transform yields the filter as run in the function, where
<span class="math notranslate nohighlight">\(f\)</span> is the <cite>frac</cite> parameter:</p>
<div class="math notranslate nohighlight">
\[\begin{split}w_\text{out}[n] =&amp; w_\text{in}[n] - (a+b)w_\text{in}[n-1]
                   + abw_\text{in}[n-2] \\
                 &amp; -(fb - fa - b - 1)w_\text{out}[n-1]
                   + (fb - fa - b)w_\text{out}[n-2]\end{split}\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.pole_zero.pole_zero">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.pole_zero.</span></span><span class="sig-name descname"><span class="pre">pole_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.pole_zero.pole_zero" title="Permalink to this definition"></a></dt>
<dd><p>Apply a pole-zero cancellation using the provided time
constant to the waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>t_tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the time constant of the exponential to be deconvolved.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the pole-zero cancelled waveform.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_pz&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pole_zero&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;400*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_pz&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.presum">
<span id="pygama-dsp-processors-presum-module"></span><h2>pygama.dsp.processors.presum module<a class="headerlink" href="#module-pygama.dsp.processors.presum" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.presum.presum">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.presum.</span></span><span class="sig-name descname"><span class="pre">presum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.presum.presum" title="Permalink to this definition"></a></dt>
<dd><p>Presum the waveform.</p>
<p>Combine bins in chunks of <code class="docutils literal notranslate"><span class="pre">len(w_in)</span> <span class="pre">/</span> <span class="pre">len(w_out)</span></code>, which is hopefully an
integer. If it isn't, then some samples at the end will be omitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the output waveform.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.pulse_injector">
<span id="pygama-dsp-processors-pulse-injector-module"></span><h2>pygama.dsp.processors.pulse_injector module<a class="headerlink" href="#module-pygama.dsp.processors.pulse_injector" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.pulse_injector.inject_exp_pulse">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.pulse_injector.</span></span><span class="sig-name descname"><span class="pre">inject_exp_pulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wf_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.pulse_injector.inject_exp_pulse" title="Permalink to this definition"></a></dt>
<dd><p>Inject exponential pulse into existing waveform to simulate pileup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wf_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>t0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the position of the injected waveform.</p></li>
<li><p><strong>rt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the rise time of the injected waveform.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the amplitude of the injected waveform.</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the exponential decay constant of the injected waveform.</p></li>
<li><p><strong>wf_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the output waveform.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.pulse_injector.inject_sig_pulse">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.pulse_injector.</span></span><span class="sig-name descname"><span class="pre">inject_sig_pulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wf_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.pulse_injector.inject_sig_pulse" title="Permalink to this definition"></a></dt>
<dd><p>Inject sigmoid pulse into existing waveform to simulate pileup.</p>
<div class="math notranslate nohighlight">
\[s(t) = \frac{A}{1 + \exp[-4 \log(99) (t - t_0 - t_r/2) / t_r]}
        e^{-(t-t_0)/\tau}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wf_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>t0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the position <span class="math notranslate nohighlight">\(t_0\)</span> of the injected waveform.</p></li>
<li><p><strong>rt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the rise time <span class="math notranslate nohighlight">\(t_r\)</span> of the injected waveform.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the amplitude <span class="math notranslate nohighlight">\(A\)</span> of the injected waveform.</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the decay parameter <span class="math notranslate nohighlight">\(\tau\)</span> of the injected waveform.</p></li>
<li><p><strong>wf_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the output waveform.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.saturation">
<span id="pygama-dsp-processors-saturation-module"></span><h2>pygama.dsp.processors.saturation module<a class="headerlink" href="#module-pygama.dsp.processors.saturation" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.saturation.saturation">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.saturation.</span></span><span class="sig-name descname"><span class="pre">saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bit_depth_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_lo_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hi_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.saturation.saturation" title="Permalink to this definition"></a></dt>
<dd><p>Count the number of samples in the waveform that are saturated at the
minimum and maximum possible values based on the bit depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform</p></li>
<li><p><strong>bit_depth_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the bit depth of the analog-to-digital converter</p></li>
<li><p><strong>n_lo_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the output number of samples at the minimum</p></li>
<li><p><strong>n_hi_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the output number of samples at the maximum</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;sat_lo, sat_hi&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;saturation&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;16&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sat_lo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sat_hi&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.soft_pileup_corr">
<span id="pygama-dsp-processors-soft-pileup-corr-module"></span><h2>pygama.dsp.processors.soft_pileup_corr module<a class="headerlink" href="#module-pygama.dsp.processors.soft_pileup_corr" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.soft_pileup_corr.soft_pileup_corr">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.soft_pileup_corr.</span></span><span class="sig-name descname"><span class="pre">soft_pileup_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.soft_pileup_corr.soft_pileup_corr" title="Permalink to this definition"></a></dt>
<dd><p>Fit the baseline to an exponential with the provided time constant and
then subtract the best-fit function from the entire waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- The input waveform.</p></li>
<li><p><strong>n_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- The number of samples at the beginning of the waveform
to fit to an exponential.</p></li>
<li><p><strong>tau_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- The fixed, exponential time constant.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- The output waveform with the exponential subtracted.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_bl&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;soft_pileup_corr&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;1000&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;500*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_bl&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.soft_pileup_corr.soft_pileup_corr_bl">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.soft_pileup_corr.</span></span><span class="sig-name descname"><span class="pre">soft_pileup_corr_bl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.soft_pileup_corr.soft_pileup_corr_bl" title="Permalink to this definition"></a></dt>
<dd><p>Fit the baseline to an exponential with the provided time
constant and then subtract the best-fit function from the
entire waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>n_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of samples at the beginning of the waveform
to fit to an exponential.</p></li>
<li><p><strong>tau_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the fixed, exponential time constant.</p></li>
<li><p><strong>b_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the fixed, exponential constant.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the output waveform with the exponential subtracted.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_bl&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;soft_pileup_corr_bl&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;1000&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;500*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;baseline&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_bl&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.time_point_thresh">
<span id="pygama-dsp-processors-time-point-thresh-module"></span><h2>pygama.dsp.processors.time_point_thresh module<a class="headerlink" href="#module-pygama.dsp.processors.time_point_thresh" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.time_point_thresh.time_point_thresh">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.time_point_thresh.</span></span><span class="sig-name descname"><span class="pre">time_point_thresh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">walk_forward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.time_point_thresh.time_point_thresh" title="Permalink to this definition"></a></dt>
<dd><p>Find the index where the waveform value crosses the threshold, walking
either forward or backward from the starting index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>a_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the threshold value.</p></li>
<li><p><strong>t_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the starting index.</p></li>
<li><p><strong>walk_forward</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the backward (<code class="docutils literal notranslate"><span class="pre">0</span></code>) or forward (<code class="docutils literal notranslate"><span class="pre">1</span></code>) search direction.</p></li>
<li><p><strong>t_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the index where the waveform value crosses the threshold.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;tp_0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;time_point_thresh&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_atrap&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bl_std&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_start&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_0&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ns&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.trap_filters">
<span id="pygama-dsp-processors-trap-filters-module"></span><h2>pygama.dsp.processors.trap_filters module<a class="headerlink" href="#module-pygama.dsp.processors.trap_filters" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.trap_filters.asym_trap_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.trap_filters.</span></span><span class="sig-name descname"><span class="pre">asym_trap_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fall</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.trap_filters.asym_trap_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply an asymmetric trapezoidal filter to the waveform, normalized by
the number of samples averaged in the rise and fall sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of samples averaged in the rise section.</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the delay between the rise and fall sections.</p></li>
<li><p><strong>fall</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of samples averaged in the fall section.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the normalized, filtered waveform.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_af&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asym_trap_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;128*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;64*ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_af&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.trap_filters.trap_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.trap_filters.</span></span><span class="sig-name descname"><span class="pre">trap_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.trap_filters.trap_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a symmetric trapezoidal filter to the waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of samples averaged in the rise and fall sections.</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the delay between the rise and fall sections.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the filtered waveform.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_tf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;trap_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;10*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_tf&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.trap_filters.trap_norm">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.trap_filters.</span></span><span class="sig-name descname"><span class="pre">trap_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.trap_filters.trap_norm" title="Permalink to this definition"></a></dt>
<dd><p>Apply a symmetric trapezoidal filter to the waveform, normalized by the
number of samples averaged in the rise and fall sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of samples averaged in the rise and fall sections.</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the delay between the rise and fall sections.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the normalized, filtered waveform.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_tf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;trap_norm&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;10*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_tf&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.trap_filters.trap_pickoff">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.trap_filters.</span></span><span class="sig-name descname"><span class="pre">trap_pickoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pickoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.trap_filters.trap_pickoff" title="Permalink to this definition"></a></dt>
<dd><p>Pick off the value at the provided index of a symmetric trapezoidal
filter to the input waveform, normalized by the number of samples averaged
in the rise and fall sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>rise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the number of samples averaged in the rise and fall sections.</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the delay between the rise and fall sections.</p></li>
<li><p><strong>t_pickoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the waveform index to pick off.</p></li>
<li><p><strong>a_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- the output pick-off value of the filtered waveform.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;ct_corr&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;trap_pickoff&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_pz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;1.5*us&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tp_0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ct_corr&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ADC&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.upsampler">
<span id="pygama-dsp-processors-upsampler-module"></span><h2>pygama.dsp.processors.upsampler module<a class="headerlink" href="#module-pygama.dsp.processors.upsampler" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.upsampler.upsampler">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.upsampler.</span></span><span class="sig-name descname"><span class="pre">upsampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.upsampler.upsampler" title="Permalink to this definition"></a></dt>
<dd><p>Upsamples the waveform by the number specified, a series of moving
windows should be applied afterwards for smoothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- waveform to upsample.</p></li>
<li><p><strong>upsample</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) -- number of samples to increase each sample to.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- output array for upsampled waveform.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.wiener_filter">
<span id="pygama-dsp-processors-wiener-filter-module"></span><h2>pygama.dsp.processors.wiener_filter module<a class="headerlink" href="#module-pygama.dsp.processors.wiener_filter" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.wiener_filter.wiener_filter">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.wiener_filter.</span></span><span class="sig-name descname"><span class="pre">wiener_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.wiener_filter.wiener_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply a Wiener filter to the waveform.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The convolution is performed in the frequency domain.  This processor is
composed of a factory function that is called using the <cite>init_args</cite>
argument. The input and output waveforms are passed using <cite>args</cite>. The input
must be the Fourier transform of the waveform. The output is the filtered
waveform in the frequency domain.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_name_array</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>]</em>) -- Array with path to an HDF5 file containing the time domain version of
the superpulse in one column and noise waveform in another, the
superpulse HDF5 group must be titled <code class="docutils literal notranslate"><span class="pre">spms/processed/superpulse</span></code> and
the noise waveform must be called <code class="docutils literal notranslate"><span class="pre">spms/processed/noise_wf</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a></p>
</dd>
</dl>
<p class="rubric">JSON Configuration Example</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;wf_wiener&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wiener_filter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pygama.dsp.processors&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;wf_bl_fft&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wf_wiener(2000,f)&quot;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dB&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;init_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/path/to/file/wiener.lh5&quot;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygama.dsp.processors.windower">
<span id="pygama-dsp-processors-windower-module"></span><h2>pygama.dsp.processors.windower module<a class="headerlink" href="#module-pygama.dsp.processors.windower" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pygama.dsp.processors.windower.windower">
<span class="sig-prename descclassname"><span class="pre">pygama.dsp.processors.windower.</span></span><span class="sig-name descname"><span class="pre">windower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#pygama.dsp.processors.windower.windower" title="Permalink to this definition"></a></dt>
<dd><p>Return a shorter sample of the waveform, starting at the
specified index.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The length of the output waveform is determined by the length of <cite>w_out</cite>
rather than an input parameter.  If the the length of <cite>w_out</cite> plus <cite>t0_in</cite>
extends past the end of <cite>w_in</cite> or if <cite>t0_in</cite> is negative, remaining values
are padded with <a class="reference external" href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="(in NumPy v1.23)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.nan</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_in</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the input waveform.</p></li>
<li><p><strong>t0_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) -- the starting index of the window.</p></li>
<li><p><strong>w_out</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>ndarray</em></a>) -- the windowed waveform.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pygama.dsp.html" class="btn btn-neutral float-left" title="pygama.dsp package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pygama.evt.html" class="btn btn-neutral float-right" title="pygama.evt package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, the LEGEND Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>